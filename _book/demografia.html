<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ecología de poblaciones silvestres</title>
  <meta name="description" content="Este es el manual del curso ‘Ecología de Poblaciones Silvestres’, de las Escuela de Ciencias Biológicas de la Universidad Nacional">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Ecología de poblaciones silvestres" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este es el manual del curso ‘Ecología de Poblaciones Silvestres’, de las Escuela de Ciencias Biológicas de la Universidad Nacional" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ecología de poblaciones silvestres" />
  
  <meta name="twitter:description" content="Este es el manual del curso ‘Ecología de Poblaciones Silvestres’, de las Escuela de Ciencias Biológicas de la Universidad Nacional" />
  

<meta name="author" content="David Martínez Cascante">


<meta name="date" content="2018-04-26">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="modelos-de-crecimiento.html">
<link rel="next" href="soluciones-a-los-ejercicios.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html"><i class="fa fa-check"></i><b>2</b> Modelos de crecimiento</a><ul>
<li class="chapter" data-level="2.1" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-denso-independiente"><i class="fa fa-check"></i><b>2.1</b> Crecimiento denso-independiente</a><ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimientogeometrico"><i class="fa fa-check"></i><b>2.1.1</b> Crecimiento geométrico</a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimientoexponencial"><i class="fa fa-check"></i><b>2.1.2</b> Crecimiento exponencial</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-denso-dependiente"><i class="fa fa-check"></i><b>2.2</b> Crecimiento denso-dependiente</a><ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-logistico"><i class="fa fa-check"></i><b>2.2.1</b> Crecimiento logístico</a></li>
<li class="chapter" data-level="2.2.2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#usos-del-modelo-logistico"><i class="fa fa-check"></i><b>2.2.2</b> Usos del modelo logístico</a></li>
<li class="chapter" data-level="2.2.3" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#matrices"><i class="fa fa-check"></i><b>2.2.3</b> Matrices</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#otras-fuentes-bibliograficas"><i class="fa fa-check"></i><b>2.3</b> Otras fuentes bibliográficas</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="demografia.html"><a href="demografia.html"><i class="fa fa-check"></i><b>3</b> Demografía</a><ul>
<li class="chapter" data-level="3.1" data-path="demografia.html"><a href="demografia.html#tablas-de-vida"><i class="fa fa-check"></i><b>3.1</b> Tablas de vida</a><ul>
<li class="chapter" data-level="3.1.1" data-path="demografia.html"><a href="demografia.html#tablas-de-vida-sobre-cohortes-tablas-horizontales"><i class="fa fa-check"></i><b>3.1.1</b> Tablas de vida sobre cohortes (tablas horizontales)</a></li>
<li class="chapter" data-level="3.1.2" data-path="demografia.html"><a href="demografia.html#tablas-de-vida-estaticas"><i class="fa fa-check"></i><b>3.1.2</b> Tablas de vida estáticas</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="demografia.html"><a href="demografia.html#curvas-de-supervivencia"><i class="fa fa-check"></i><b>3.2</b> Curvas de supervivencia</a></li>
<li class="chapter" data-level="3.3" data-path="demografia.html"><a href="demografia.html#analisis-de-curvas-de-captura"><i class="fa fa-check"></i><b>3.3</b> Análisis de Curvas de Captura</a><ul>
<li class="chapter" data-level="3.3.1" data-path="demografia.html"><a href="demografia.html#metodo-de-chapman-y-robson-1960.-estimacion-de-supervivencia-usando-todas-las-clases-de-edad"><i class="fa fa-check"></i><b>3.3.1</b> Método de Chapman y Robson 1960. Estimación de supervivencia usando todas las clases de edad</a></li>
<li class="chapter" data-level="3.3.2" data-path="demografia.html"><a href="demografia.html#metodo-de-regresion"><i class="fa fa-check"></i><b>3.3.2</b> Método de regresión</a></li>
<li class="chapter" data-level="3.3.3" data-path="demografia.html"><a href="demografia.html#ejercicios-2"><i class="fa fa-check"></i><b>3.3.3</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="demografia.html"><a href="demografia.html#matrices-de-transicion"><i class="fa fa-check"></i><b>3.4</b> Matrices de transición</a><ul>
<li class="chapter" data-level="3.4.1" data-path="demografia.html"><a href="demografia.html#proyeccion-de-una-matriz-a-n_t1"><i class="fa fa-check"></i><b>3.4.1</b> Proyección de una matriz a <span class="math inline">\(N_{t+1}\)</span></a></li>
<li class="chapter" data-level="3.4.2" data-path="demografia.html"><a href="demografia.html#el-paquete-popbio"><i class="fa fa-check"></i><b>3.4.2</b> El paquete <strong>popbio</strong></a></li>
<li class="chapter" data-level="3.4.3" data-path="demografia.html"><a href="demografia.html#viabilidad-de-poblaciones"><i class="fa fa-check"></i><b>3.4.3</b> Viabilidad de poblaciones</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="demografia.html"><a href="demografia.html#otras-fuentes-bibliograficas-1"><i class="fa fa-check"></i><b>3.5</b> Otras fuentes bibliográficas</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="soluciones-a-los-ejercicios.html"><a href="soluciones-a-los-ejercicios.html"><i class="fa fa-check"></i><b>4</b> Soluciones a los ejercicios</a></li>
<li class="appendix"><span><b>Apéndices</b></span></li>
<li class="chapter" data-level="A" data-path="metodos-numericos-para-ecologia-de-poblaciones.html"><a href="metodos-numericos-para-ecologia-de-poblaciones.html"><i class="fa fa-check"></i><b>A</b> Métodos numéricos para ecología de poblaciones</a><ul>
<li class="chapter" data-level="A.1" data-path="metodos-numericos-para-ecologia-de-poblaciones.html"><a href="metodos-numericos-para-ecologia-de-poblaciones.html#simulacion-de-ecuaciones-diferenciales"><i class="fa fa-check"></i><b>A.1</b> Simulación de ecuaciones diferenciales</a></li>
<li class="chapter" data-level="A.2" data-path="metodos-numericos-para-ecologia-de-poblaciones.html"><a href="metodos-numericos-para-ecologia-de-poblaciones.html#error-en-las-simulaciones"><i class="fa fa-check"></i><b>A.2</b> Error en las simulaciones</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html"><i class="fa fa-check"></i><b>B</b> Tutorial de R con RStudio</a><ul>
<li class="chapter" data-level="B.1" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#RStudioProject"><i class="fa fa-check"></i><b>B.1</b> Crear un proyecto en <em>RStudio</em></a></li>
<li class="chapter" data-level="B.2" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#funciones-basicas-en-r"><i class="fa fa-check"></i><b>B.2</b> Funciones básicas en R</a></li>
<li class="chapter" data-level="B.3" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#estructuras-de-datos"><i class="fa fa-check"></i><b>B.3</b> Estructuras de datos</a></li>
<li class="chapter" data-level="B.4" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#funciones"><i class="fa fa-check"></i><b>B.4</b> Funciones</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="asignaciones.html"><a href="asignaciones.html"><i class="fa fa-check"></i><b>C</b> Asignaciones</a><ul>
<li class="chapter" data-level="C.1" data-path="asignaciones.html"><a href="asignaciones.html#tarea-01-hola-mundo-con-rmarkdown"><i class="fa fa-check"></i><b>C.1</b> Tarea 01: ¡Hola mundo con <em>Rmarkdown</em>!</a></li>
<li class="chapter" data-level="C.2" data-path="asignaciones.html"><a href="asignaciones.html#tarea-02-ejercicios-de-crecimiento"><i class="fa fa-check"></i><b>C.2</b> Tarea 02: Ejercicios de crecimiento</a><ul>
<li class="chapter" data-level="C.2.1" data-path="asignaciones.html"><a href="asignaciones.html#instrucciones"><i class="fa fa-check"></i><b>C.2.1</b> Instrucciones</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="asignaciones.html"><a href="asignaciones.html#tarea-03-colabora-en-el-trabajo-grupal"><i class="fa fa-check"></i><b>C.3</b> Tarea 03: Colabora en el trabajo grupal</a><ul>
<li class="chapter" data-level="C.3.1" data-path="asignaciones.html"><a href="asignaciones.html#objetivo-general"><i class="fa fa-check"></i><b>C.3.1</b> Objetivo general</a></li>
<li class="chapter" data-level="C.3.2" data-path="asignaciones.html"><a href="asignaciones.html#instrucciones-1"><i class="fa fa-check"></i><b>C.3.2</b> Instrucciones</a></li>
<li class="chapter" data-level="C.3.3" data-path="asignaciones.html"><a href="asignaciones.html#problemas"><i class="fa fa-check"></i><b>C.3.3</b> <strong>Problemas</strong></a></li>
</ul></li>
<li class="chapter" data-level="C.4" data-path="asignaciones.html"><a href="asignaciones.html#tarea-04-ejercicios-con-tablas-de-vida"><i class="fa fa-check"></i><b>C.4</b> Tarea 04: Ejercicios con tablas de vida</a><ul>
<li class="chapter" data-level="C.4.1" data-path="asignaciones.html"><a href="asignaciones.html#objetivo-general-1"><i class="fa fa-check"></i><b>C.4.1</b> Objetivo general</a></li>
<li class="chapter" data-level="C.4.2" data-path="asignaciones.html"><a href="asignaciones.html#instrucciones-2"><i class="fa fa-check"></i><b>C.4.2</b> Instrucciones</a></li>
<li class="chapter" data-level="C.4.3" data-path="asignaciones.html"><a href="asignaciones.html#presentacion"><i class="fa fa-check"></i><b>C.4.3</b> Presentación</a></li>
</ul></li>
<li class="chapter" data-level="C.5" data-path="asignaciones.html"><a href="asignaciones.html#tarea-05-matrices-de-transicion"><i class="fa fa-check"></i><b>C.5</b> Tarea 05: Matrices de transición</a><ul>
<li class="chapter" data-level="C.5.1" data-path="asignaciones.html"><a href="asignaciones.html#objetivo"><i class="fa fa-check"></i><b>C.5.1</b> Objetivo</a></li>
</ul></li>
<li class="chapter" data-level="C.6" data-path="asignaciones.html"><a href="asignaciones.html#instrucciones-3"><i class="fa fa-check"></i><b>C.6</b> Instrucciones</a></li>
<li class="chapter" data-level="C.7" data-path="asignaciones.html"><a href="asignaciones.html#contexto"><i class="fa fa-check"></i><b>C.7</b> Contexto</a></li>
<li class="chapter" data-level="C.8" data-path="asignaciones.html"><a href="asignaciones.html#instrucciones-4"><i class="fa fa-check"></i><b>C.8</b> Instrucciones</a></li>
<li class="chapter" data-level="C.9" data-path="asignaciones.html"><a href="asignaciones.html#tarea-06"><i class="fa fa-check"></i><b>C.9</b> Tarea 06</a></li>
<li class="chapter" data-level="C.10" data-path="asignaciones.html"><a href="asignaciones.html#trabajo-individual"><i class="fa fa-check"></i><b>C.10</b> Trabajo individual</a><ul>
<li class="chapter" data-level="C.10.1" data-path="asignaciones.html"><a href="asignaciones.html#objetivo-general-2"><i class="fa fa-check"></i><b>C.10.1</b> Objetivo general</a></li>
<li class="chapter" data-level="C.10.2" data-path="asignaciones.html"><a href="asignaciones.html#instrucciones-5"><i class="fa fa-check"></i><b>C.10.2</b> Instrucciones</a></li>
<li class="chapter" data-level="C.10.3" data-path="asignaciones.html"><a href="asignaciones.html#exposicion"><i class="fa fa-check"></i><b>C.10.3</b> Exposición</a></li>
<li class="chapter" data-level="C.10.4" data-path="asignaciones.html"><a href="asignaciones.html#sugerencias"><i class="fa fa-check"></i><b>C.10.4</b> Sugerencias</a></li>
</ul></li>
<li class="chapter" data-level="C.11" data-path="asignaciones.html"><a href="asignaciones.html#trabajo-grupal"><i class="fa fa-check"></i><b>C.11</b> Trabajo grupal</a><ul>
<li class="chapter" data-level="C.11.1" data-path="asignaciones.html"><a href="asignaciones.html#objetivo-general-3"><i class="fa fa-check"></i><b>C.11.1</b> Objetivo general</a></li>
<li class="chapter" data-level="C.11.2" data-path="asignaciones.html"><a href="asignaciones.html#objetivos-especificos"><i class="fa fa-check"></i><b>C.11.2</b> Objetivos específicos</a></li>
<li class="chapter" data-level="C.11.3" data-path="asignaciones.html"><a href="asignaciones.html#justificacion"><i class="fa fa-check"></i><b>C.11.3</b> Justificación</a></li>
<li class="chapter" data-level="C.11.4" data-path="asignaciones.html"><a href="asignaciones.html#definiciones"><i class="fa fa-check"></i><b>C.11.4</b> Definiciones</a></li>
<li class="chapter" data-level="C.11.5" data-path="asignaciones.html"><a href="asignaciones.html#metas"><i class="fa fa-check"></i><b>C.11.5</b> Metas</a></li>
<li class="chapter" data-level="C.11.6" data-path="asignaciones.html"><a href="asignaciones.html#flujo-semanal-de-trabajo"><i class="fa fa-check"></i><b>C.11.6</b> Flujo semanal de trabajo</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ecología de poblaciones silvestres</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="demografia" class="section level1">
<h1><span class="header-section-number">Capítulo 3</span> Demografía</h1>
<p>En el primer capítulo del material del curso, tratamos algunos modelos de crecimiento, donde factores importantes, como el sexo, la edad y el estado reproductivo de los organismos fueron ignorados. Anteriormente, consideramos a las poblaciones como una masa sin estructura que crece en relación al tiempo, y su propio tamaño. Esto tiene consecuencias importantes a la hora de contrastar las predicciones de los modelos, con datos reales sobre poblaciones.</p>
<p>Por ejemplo, en muchas poblaciones aprovechadas, los métodos de captura tienen alta selectividad para ciertas tallas o edades. Por tanto, existe un componente que provoca un efecto asimétrico en la mortalidad de una clase de edad a la siguiente.</p>
<p>Utilizar estructuras de edades en los modelos de dinámica de poblaciones, permite predecir algunos efectos de acciones de manejo. Por ejemplo, ¿qué pasa si distribuimos la mortalidad de manera equitativa en todas las clases de edad, o qué pasa si cargamos la mortalidad en cierta clase de edad pero no en las otras? Este tema se refleja en los reglamentos de tallas mínimas para la pesca en Costa Rica, por ejemplo.</p>
<p>La estructura por edades, puede entenderse como el aporte de cada clase de edad a la fecundidad, y a la supervivencia de una clase a la siguiente. Por ejemplo, podemos pensar en un modelo sencillo donde tenemos tres estados en una población: neonatos, juveniles y adultos. Los nonatos aportan individuos desde su clase, hacia los juveniles. Los juveniles pueden reproducirse tempranamente, y aportar individuos a los neonatos mediante la reproducción; además, aquellos que sobrevivan pasarán a la clase adulta. Por último, la clase adulta aportará muchos individuos a los neonatos mediante la reproducción, y algunos de ellos sobrevivirán y permanecerán en la misma clase en la siguiente generación (Figura <a href="demografia.html#fig:demoTMintro">3.1</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:demoTMintro"></span>
<img src="dinPob_files/figure-html/demoTMintro-1.png" alt="Ejemplo de las transiciones entre clases de edad" width="480" />
<p class="caption">
Figure 3.1: Ejemplo de las transiciones entre clases de edad
</p>
</div>
<p>En las secciones posteriores, aprenderemos los fundamentos del uso de modelos estructurados por edad, y sus aplicaciones al manejo de recursos naturales. Para ayudar a la comprensión de la teoría, y su aplicación a datos reales, utilizaremos el paquete <code>popbio</code> de .</p>
<p>Debemos instalarlo en la computadora, utilizando las siguientes líneas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&quot;popbio&quot;</span>)</code></pre></div>
<div id="tablas-de-vida" class="section level2">
<h2><span class="header-section-number">3.1</span> Tablas de vida</h2>
<p>Las tablas de vida resumen un estudio longitudinal, que investiga el destino de los individuos de una <em>cohorte</em>  durante su vida (o una muestra de la cohorte). Usualmente, la primer columna de una tabla de vida consiste del número de individuos en una clase de edad. Y las clases de edad, dependen del ciclo de vida de los organismos.</p>
<p>Este ordenamiento de los datos permite investigar cuántos individuos sobreviven de una clase de edad a la siguiente. Y a partir de aquí, se construyen otros valores poblacionales importantes.</p>
<p>Para construir una tabla de vida, debemos seguir los siguientes pasos:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(x\)</span>: Definir un intervalo de edad, que sea apropiado para el ciclo de vida de la especie. Puede indicarse únicamente el valor inicial del intervalo en la columna, pero lo ideal es trabajar con el punto medio del intervalo de clase. Por ejemplo, para el intervalo <span class="math inline">\([a, b)\)</span>, calculamos el punto medio del intervalo como <span class="math inline">\(x = (a+b)/2\)</span>.</p></li>
<li><p><span class="math inline">\(S_x\)</span>: Indicar el número de supervivientes en esa clase de edad.</p></li>
<li><p><span class="math inline">\(D_x\)</span>: Anotar el número de muertes en esa clase de edad. Se calcula como <span class="math inline">\(D_x = S_x - S_{x+1}\)</span>.</p></li>
<li><p><span class="math inline">\(l_x\)</span>: Calcular la proporción de sobrevivientes con respecto al número de individuos en la primer clase de edad <span class="math inline">\(S_0\)</span>. Para cada fila de la tabla de vida, calcular <span class="math inline">\(l_x = S_x/S_0\)</span>.</p></li>
<li><p><span class="math inline">\(d_x\)</span>: Se calcula como <span class="math inline">\(D_x\)</span>, pero la columna con los datos de entrada es <span class="math inline">\(l_x\)</span>. Es decir: <span class="math inline">\(d_x=l_x-l_{x+1}\)</span>.</p></li>
<li><p><span class="math inline">\(q_x\)</span>: La tasa de mortalidad, que se calcula como <span class="math inline">\(q_x = D_x/S_x\)</span> ó <span class="math inline">\(q_x = d_x/l_x\)</span>.</p></li>
<li><p><span class="math inline">\(e_x\)</span>: La esperanza de vida promedio. Esta se calcula al sumar todos los sobrevivientes desde la clase de edad <span class="math inline">\(x\)</span> hasta la última, dividido entre el número de supervivientes en la clase <span class="math inline">\(x\)</span>. Esta manera de calcular <span class="math inline">\(e_x\)</span> supone que todos los individuos sobreviven desde e inicio de la clase de edad hasta el final y luego mueren. Para corregir restamos a este valor la mitad de la amplitud del intervalo en la clase de edad <span class="math inline">\(x\)</span>. Es decir, si la amplitud del intervalo es un año, entonces restamos <span class="math inline">\(0.5\left\Vert x \right\Vert =0.5(1)\)</span>. La fórmula Si tenemos <span class="math inline">\(n\)</span> clases de edad, entonces calculamos <span class="math inline">\(e_x = (\sum_{i=x}^n{S_i})/S_x - 0.5\left\Vert x \right\Vert\)</span>.</p></li>
</ol>
<p>Los cálculos anteriores son interesantes, pero aún hay datos que se pueden añadir para sacar todo el provecho de las tablas de vida: los datos de reproducción. En el caso de animales, las tablas suelen trabajarse con el número de hembras; además, pueden añadirse datos sobre la descendencia que produce cada hembra (contando también solo los individuos de este sexo). Por lo tanto, a las columnas anteriores añadimos las siguientes:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(m_x\)</span>: El número de descendientes hembras por cada hembra de la clase <span class="math inline">\(x\)</span></p></li>
<li><p><span class="math inline">\(m_x l_x\)</span>: La producción de nuevas hembras por clase de edad.</p></li>
<li><p><span class="math inline">\(x\,m_x l_x\)</span>: paso intermedio para calcular parámetros reproductivos.</p></li>
</ol>
<p>Y con los resultados de una tabla como esta, podemos calcular parámetros importantes como la tasa de crecimiento neta  (<span class="math inline">\(R_0\)</span>), que es la cantidad promedio de descendientes hembras que produce una hembra a lo largo de su vida. También podemos calcular el tiempo medio de generación (<span class="math inline">\(T_c\)</span>), que es tiempo que en promedio dura una hembra en producir una cantidad de descendientes hembra igual a la tasa de crecimiento neta, <span class="math inline">\(R_0\)</span>. Estos parámetros los calculamos como:</p>
<p><span class="math display">\[
\begin{split}
R_0 &amp;= \sum l_x m_x\\
T_c &amp;= \sum x\, m_x l_x\\
\end{split}
\]</span></p>
<p>El <span class="math inline">\(R_0\)</span> es un reflejo de la tasa de multiplicación (<span class="math inline">\(\lambda\)</span>, ver sección <a href="modelos-de-crecimiento.html#crecimientogeometrico">2.1.1</a>). Es decir, la población crece si <span class="math inline">\(R_0 &gt; 1\)</span>, se mantiene estable si <span class="math inline">\(R_0 =1\)</span>, y decrece si <span class="math inline">\(R_0 &lt; 1\)</span>.</p>
<p>También podemos relacionarlo con la tasa intrínseca de crecimiento per cápita <span class="math inline">\(\mathrm{r_m}\)</span> (ver sección <a href="modelos-de-crecimiento.html#crecimientoexponencial">2.1.2</a>). Para ello usamos la siguiente relación:</p>
<p><span class="math display">\[
\mathrm{r_m} \approx \frac{\ln(R_0)}{T_c}
\]</span></p>
<div id="tablas-de-vida-sobre-cohortes-tablas-horizontales" class="section level3">
<h3><span class="header-section-number">3.1.1</span> Tablas de vida sobre cohortes (tablas horizontales)</h3>
<p>Este tipo de tablas se construyen al seguir un grupo de organismos de una misma cohorte o generación. Es más utilizado en plantas o animales sésiles; sin embargo, con el financiamiento y el equipo correcto, puede ser utilizado en animales móviles.</p>
<p>El paquete <strong>popbio</strong> de , ofrece varios conjuntos de datos. Uno de ellos sobre una planta llamada <em>Aquilegia</em>. El conjunto de datos contiene información sobre cada planta, y su destino después de muestreos anuales.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(popbio)<span class="co"># cargar paquete</span>
<span class="kw">data</span>(<span class="st">&quot;aq.trans&quot;</span>)<span class="co">#cargar datos</span>
aq.trans -&gt;<span class="st"> </span>dat; <span class="kw">rm</span>(aq.trans)<span class="co">#crear objeto de trabajo</span>

<span class="co">#arreglar niveles del factor</span>
dat<span class="op">$</span>status &lt;-<span class="st"> </span><span class="kw">factor</span>(dat<span class="op">$</span>stage, <span class="kw">levels</span>(<span class="kw">factor</span>(dat<span class="op">$</span>stage))[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])
<span class="kw">attach</span>(dat)
<span class="kw">head</span>(dat,<span class="dv">5</span>)<span class="co"># muestra las primeras 5 filas de datos</span></code></pre></div>
<pre><code>##   plot year plant  stage leaf rose fruits  fate rose2 status
## 1  903 1996     1  small    0    0      0 small    NA  small
## 2  903 1996     2 flower   NA   NA      1 large    NA flower
## 3  903 1996     3  small    0    0      0 large    NA  small
## 4  903 1996     4  small    1   NA      0 small     0  small
## 5  903 1996     7  small    2   NA      0 large    NA  small</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Construimos una matriz con los datos de sobrevivencia</span>
(pop &lt;-<span class="st"> </span><span class="kw">table</span>(year,status))</code></pre></div>
<pre><code>##       status
## year   recruit small large flower
##   1996      12   134    17     62
##   1997     287    75    68      6
##   1998     186    60    41     80
##   1999      76    84    57     74
##   2000       5    58    59     52
##   2001       5    31    58      8
##   2002       0    13    16      0
##   2003       3     6     4      0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Escogemos una diagonal de la matriz (cohorte)</span>
Sx &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">4</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>){
  Sx[i] &lt;-<span class="st"> </span>pop[(i<span class="op">+</span><span class="dv">2</span>),i]
}

aqData &lt;-<span class="st"> </span><span class="kw">tablaVida</span>(<span class="dt">x.sup =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">Sx =</span> Sx)
<span class="kw">rm</span>(dat, pop, i)<span class="co"># Limpiar un poco</span></code></pre></div>
<p>Si aplicamos las fórmulas que hemos visto en clase, obtenemos la siguiente tabla de vida:</p>
<p></p>
<table>
<caption><span id="tab:Aquilegia">Table 3.1: </span> Tabla de vida para una cohorte de <em>Aquilegia</em>.</caption>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(x\)</span></th>
<th align="center"><span class="math inline">\(S_x\)</span></th>
<th align="center"><span class="math inline">\(D_x\)</span></th>
<th align="center"><span class="math inline">\(l_x\)</span></th>
<th align="center"><span class="math inline">\(d_x\)</span></th>
<th align="center"><span class="math inline">\(q_x\)</span></th>
<th align="center"><span class="math inline">\(e_x\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">186</td>
<td align="center">102</td>
<td align="center">1.000</td>
<td align="center">0.548</td>
<td align="center">0.548</td>
<td align="center">1.312</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">84</td>
<td align="center">25</td>
<td align="center">0.452</td>
<td align="center">0.134</td>
<td align="center">0.298</td>
<td align="center">1.298</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">59</td>
<td align="center">51</td>
<td align="center">0.317</td>
<td align="center">0.274</td>
<td align="center">0.864</td>
<td align="center">0.636</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">8</td>
<td align="center">NA</td>
<td align="center">0.043</td>
<td align="center">NA</td>
<td align="center">NA</td>
<td align="center">0.500</td>
</tr>
</tbody>
</table>

</div>
<div id="tablas-de-vida-estaticas" class="section level3">
<h3><span class="header-section-number">3.1.2</span> Tablas de vida estáticas</h3>
<p>Para algunos animales grandes y longevos, no es práctico construir tablas de vida horizontales. Así que se toman datos en un momento determinado de tiempo, y la tabla se construye a partir de esta información.</p>
<p><strong>Tablas de vida verticales o tiempo-específicas</strong>— Estas tablas se construyen cuando se conoce la edad de los organismos. Entonces, se cuentan cuántos individuos hay en cada clase de edad; posteriormente, se cuentan las muertes en cada clase de edad, y se combina la información para construir una tabla de vida.</p>
<p><strong>Tablas estacionarias basadas en la edad a la muerte</strong>— Estas tablas se construyen con información de cadáveres, o partes de éstos. La edad en los cadáveres debe poder ser establecida claramente para que el método funcione. En <span class="citation">Neal (<a href="#ref-NealPopBio">2004</a>)</span>, se explica el método con un ejemplo basado en el carnero de Dali <em>Ovis dalli</em>. Donde el investigador recolectó cráneos y determinó la edad de cada uno.</p>
<p>Por ejemplo, si recolecto 1000 mandíbulas de algún mamífero, y puedo datar estos huesos, el primer paso es asumir que estos 1000 individuos constituyen la primer clase de edad. Luego, si el número de mandíbulas en la segunda clase de edad <span class="math inline">\(S_2\)</span> es 600, resto el <span class="math inline">\(S_x\)</span> anterior a esta cantidad, y así calculo <span class="math inline">\(D_1\)</span>. Es decir, <span class="math inline">\(D_1=1000-600\)</span>. Y así sucesivamente.</p>
<p><strong>Tablas estacionarias basadas en la estructura de edad de la población</strong>— Si la población no cambia en tamaño (la tasa de natalidad iguala la tasa de mortalidad), y si la estructura de edad es un reflejo de la Supervivencia (<span class="math inline">\(S_x\)</span>): podemos asumir que la edad de los individuos puede ser datada de manera precisa, y que hemos obtenido una muestra representativa de la población <span class="citation">(Neal <a href="#ref-NealPopBio">2004</a>)</span>. Esto quiere decir, que podemos utilizar la frecuencia en cada clase de edad, y asumir que corresponde a la supervivencia. Y que el cambio de frecuencia de una clase de edad a la siguiente se debe a la mortalidad (<span class="math inline">\(D_x\)</span>).</p>
</div>
</div>
<div id="curvas-de-supervivencia" class="section level2">
<h2><span class="header-section-number">3.2</span> Curvas de supervivencia</h2>
<p>Las tablas de vida pueden mostrar algunos detalles de las estrategias de supervivencia de los organismos. Por ejemplo, ¿tienen cuidado parental, o confían en un gran número de juveniles (o huevos, larvas, semillas) de los cuales un pequeño porcentaje de ellos llegarán a ser adultos?</p>
<p>Para ello, podemos utilizar directamente la columna <span class="math inline">\(S_x\)</span> y graficarla contra la columna <span class="math inline">\(x\)</span>. Sin embargo, si queremos comparar entre distintas especies, o contra diferentes experimentos o estudios, lo ideal es utilizar una columna normalizada como <span class="math inline">\(l_x\)</span>. En algunos casos, para mejorar la visualización de los datos, se multiplica la columna <span class="math inline">\(l_x\)</span> por un factor, generalmente un factor de mil, para mostrar la supervivencia por cada mil individuos.</p>
<p>También se puede explorar la mortalidad en cada clase de edad, siguiendo un procedimiento similar; pero, reemplazando <span class="math inline">\(l_x\)</span> por <span class="math inline">\(q_x\)</span>. Para ilustrar el procedimiento podemos utilizar los datos del Cuadro <a href="demografia.html#tab:Aquilegia">3.1</a>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">op &lt;-<span class="st"> </span><span class="kw">par</span>()
<span class="kw">par</span>( <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">5</span>) <span class="op">+</span><span class="st"> </span><span class="fl">0.1</span>)

<span class="kw">plot</span>(aqData[,<span class="dv">1</span>],aqData[,<span class="dv">4</span>]<span class="op">*</span><span class="dv">1000</span>,
     <span class="dt">xlab =</span> <span class="st">&quot;Edad&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)

<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">1000</span>))
<span class="kw">lines</span>(aqData[,<span class="dv">1</span>],aqData[,<span class="dv">4</span>]<span class="op">*</span><span class="dv">1000</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">2</span>, <span class="st">&quot;Supervivencia x 1000&quot;</span>,  <span class="dt">line =</span> <span class="dv">3</span>)

<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">1</span>, <span class="dt">at =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)

<span class="kw">axis</span>(<span class="dt">side =</span> <span class="dv">4</span>, <span class="dt">at =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">1000</span>))
<span class="kw">lines</span>(aqData[,<span class="dv">1</span>],aqData[,<span class="dv">6</span>]<span class="op">*</span><span class="dv">1000</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;darkgray&quot;</span>)
<span class="kw">mtext</span>(<span class="dt">side =</span> <span class="dv">4</span>, <span class="st">&quot;Mortalidad x 1000&quot;</span>, <span class="dt">line =</span> <span class="dv">3</span>)

<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Supervivencia&quot;</span>, <span class="st">&quot;mortalidad&quot;</span>),
       <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="st">&quot;darkgray&quot;</span>))</code></pre></div>
<div class="figure"><span id="fig:aqDataPlot"></span>
<img src="dinPob_files/figure-html/aqDataPlot-1.png" alt="Supervivencia y mortalidad de *Aquilegia*" width="672" />
<p class="caption">
Figure 3.2: Supervivencia y mortalidad de <em>Aquilegia</em>
</p>
</div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(op)
<span class="kw">rm</span>(aqData)</code></pre></div>
</div>
<div id="analisis-de-curvas-de-captura" class="section level2">
<h2><span class="header-section-number">3.3</span> Análisis de Curvas de Captura</h2>
<p>Las curvas de captura fueron desarrolladas para analizar datos en pesquerías. Su objetivo es determinar la tasa de supervivencia, o mortalidad, para una población. Este método asume que todas las clases de edad tienen una misma tasa de supervivencia.</p>
<p>Es una herramienta general que puede ser utilizada con tablas de vida estacionarias. En general, el análisis de curvas de captura puede ser utilizado en casos donde se tengan frecuencias de individuos por clase de edad.</p>
<p>El análisis de curvas de captura, también puede utilizarse con datos de tallas; siempre y cuando, exista una función que relaciones las tallas con la edad. En este último caso, hay que considerar la incertidumbre que existe al convertir tallas a edades .</p>
<div class="figure" style="text-align: center"><span id="fig:plotSiphonariaCC"></span>
<img src="dinPob_files/figure-html/plotSiphonariaCC-1.png" alt="Histograma de tallas de \textit{Siphonaria gigas} en el RNVS Playa Hermosa-Punta Mala. Datos de 2017-2018." width="336" />
<p class="caption">
Figure 3.3: Histograma de tallas de  en el RNVS Playa Hermosa-Punta Mala. Datos de 2017-2018.
</p>
</div>
<p>En la mayoría de los casos, tanto con datos de edades como tallas, existirán clases pobremente representadas (Figura <a href="demografia.html#fig:plotSiphonariaCC">3.3</a>). Esto se debe a que la probabilidad de captura con ese método específico varía en función de la edad o talla. También puede significar que existe una separación espacial en las diferentes edades de la especie; y por tanto, que no fueron representadas en el muestreo.</p>
<p>Cuando esto sucede, se utiliza la sección descendente de la curva, y se asume que todas las clases contenidas en esa sección están bien representadas. Una vez que se ha seleccionado el sub-conjunto de datos con el cual se hará la estimación, se pueden utilizar varios métodos para estimar la tasa de supervivencia (o mortalidad).</p>
<div id="metodo-de-chapman-y-robson-1960.-estimacion-de-supervivencia-usando-todas-las-clases-de-edad" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Método de Chapman y Robson 1960. Estimación de supervivencia usando todas las clases de edad</h3>
<p>Este método se deriva de asumir que los conteos de individuos supervivientes provienen de una distribución de probabilidad multinomial. En cada una de las clases de edad, la probabilidad de obtener un individuo de edad <span class="math inline">\(x\)</span> tiene una distribución geométrica: <span class="math inline">\(f_X(x)=(1-s)s^x\)</span>. Donde <span class="math inline">\(s\)</span> es la probabilidad de sobrevivencia que se desea estimar.</p>
<p>El desarrollo del estimador de <span class="math inline">\(s\)</span>, se detalla en <span class="citation">Skalski, Ryding, and Millspaugh (<a href="#ref-wildlifeDemography2005">2005</a>)</span>. Y se basa en el concepto de <em>máxima verosimilitud</em>. Su fórmula es sencilla:</p>
<p><span class="math display">\[
\hat{s} = \frac{T}{n+T-1}
\]</span></p>
<p>Donde <span class="math inline">\(n\)</span> es el tamaño de la muestra. <span class="math inline">\(T = \sum_{i=1}^n x_i\)</span>, es decir la suma de las edades de todos los individuos en la muestra. La varianza de <span class="math inline">\(\hat{s}\)</span>, se calcula como:</p>
<p><span class="math display">\[
\mathrm{Var}(\hat{s}) = \hat{s}\left( \hat{s} - \frac{T-1}{n+T - 2} \right)
\]</span></p>
<p>Suponer que todas las clases de edad mantienen una tasa de supervivencia común es arriesgado. Las suposiciones que se deben cumplir para aplicar este modelo con seguridad son:</p>
<ol style="list-style-type: decimal">
<li><p>Existe una estructura de edad estable.</p></li>
<li><p>La población es estacionaria.</p></li>
<li><p>Todos los animales tienen una misma probabilidad de selección(captura).</p></li>
<li><p>La muestra es representativa de la población.</p></li>
<li><p>El destino de todos los animales es independiente.</p></li>
<li><p>Todas las edades se estiman sin error.</p></li>
<li><p>La probabilidad de supervivencia anual es constante a través de todas las clases de edad.</p></li>
</ol>
</div>
<div id="metodo-de-regresion" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Método de regresión</h3>
<p>De manera alternativa, se puede utilizar una simple regresión lineal para estimar una tasa de supervivencia común a todas las clases de edad. Para ello, asumimos que el número esperado de individuos contados en una clase de edad <span class="math inline">\(x\)</span> (<span class="math inline">\(S_x\)</span>), es igual un número de reclutas <span class="math inline">\(N_0\)</span>, que se mantiene constante a través del tiempo; multiplicado por la probabilidad de que un individuo sea capturado en la muestra <span class="math inline">\(p\)</span>; multiplicado por probabilidad de haber sobrevivido hasta la clase <span class="math inline">\(x\)</span> (<span class="math inline">\(s^x\)</span>). Es decir:</p>
<p><span class="math display">\[
E\left( S_x \right)  = N_0 p s^x
\]</span></p>
<p>Si tomamos logaritmo a ambos lados de la expresión anterior, obtenemos:</p>
<p><span class="math display">\[
\ln(\bar{S_x}) = \ln(N_0 p) + x\ln(s)
\]</span></p>
<p>Que presenta la forma familiar de una línea recta: <span class="math inline">\(y=a+bx\)</span>. Lo importante aquí, es reconocer que <span class="math inline">\(s = e^b\)</span>. Así que al estimar los parámetros de la recta, podemos derivar la tasa de supervivencia <span class="math inline">\(s\)</span>.</p>

<div class="example">
<span id="exm:regresionSupervivencia" class="example"><strong>Example 3.1  </strong></span>Calcular la tasa de sobrevivencia, usando los datos de Aquilegia (Cuadro <a href="demografia.html#tab:Aquilegia">3.1</a>)
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Definir los datos para la regresión</span>
y &lt;-<span class="st"> </span><span class="kw">log</span>(Sx) <span class="co">#Sx, es el conteo de supervivientes de Aquilegia</span>
x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">4</span> <span class="co"># Las clases de edad</span>

salida &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="dt">formula =</span> y<span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">gaussian</span>(<span class="dt">link =</span> <span class="st">&quot;identity&quot;</span>))
s &lt;-<span class="st"> </span><span class="kw">signif</span>(
  <span class="kw">exp</span>(<span class="kw">coef</span>(salida)[<span class="dv">2</span>]),
  <span class="dt">digits =</span> <span class="dv">3</span>)

sLim &lt;-<span class="st"> </span><span class="kw">signif</span>(
                <span class="kw">exp</span>(<span class="kw">confint</span>(salida)[<span class="dv">2</span>,]),
                <span class="dt">digits =</span> <span class="dv">3</span>)</code></pre></div>
<p>Con el código de arriba, obtenemos que <span class="math inline">\(s =\)</span>  , con un intervalo de confianza al  de .</p>
<div class="figure" style="text-align: center"><span id="fig:plotAquilegiaCC"></span>
<img src="dinPob_files/figure-html/plotAquilegiaCC-1.png" alt="Verificación de ajuste del modelo a los datos de     extit{Aquilegia}. Los puntos debería aparecer alineados con la recta de mejor ajuste" width="336" />
<p class="caption">
Figure 3.4: Verificación de ajuste del modelo a los datos de extit{Aquilegia}. Los puntos debería aparecer alineados con la recta de mejor ajuste
</p>
</div>
</div>
<div id="ejercicios-2" class="section level3">
<h3><span class="header-section-number">3.3.3</span> Ejercicios</h3>

<div class="exercise">
<span id="exr:R0" class="exercise"><strong>Exercise 3.1  </strong></span>¿Cual es el significado ecológico de <span class="math inline">\(R_0\)</span>?
</div>


<div class="exercise">
<span id="exr:lambdaFromR0" class="exercise"><strong>Exercise 3.2  </strong></span>Si a usted le piden hacerse cargo de determinar el éxito de un programa de re-introducción, basado en el éxito reproductivo de la especie: Enumere los pasos a seguir para determinar si la especie se reproduce exitósamente, utilizando las herramientas vistas en las tablas de vida? Asuma que ud puede muestrear una cohorte de principio a fin.
</div>


<div class="exercise">
<span id="exr:calcRe" class="exercise"><strong>Exercise 3.3  </strong></span>Calcule si la siguiente población está creciendo, se mantiene estable o está decreciendo:
</div>

<pre><code>##       x Sx  mx
## [1,]  5 20 0.0
## [2,] 10 45 0.0
## [3,] 15 10 1.2
## [4,] 20  5 1.1</code></pre>

<div class="exercise">
<span id="exr:ovisDalli" class="exercise"><strong>Exercise 3.4  </strong></span>En <span class="citation">Neal (<a href="#ref-NealPopBio">2004</a>)</span> se presentan los datos sobre el estudio de <em>Ovis dalli</em>. Calcule la tabla de vida:
</div>

<pre><code>##        x  Sx
##  [1,]  1 608
##  [2,]  2 487
##  [3,]  3 480
##  [4,]  4 472
##  [5,]  5 465
##  [6,]  6 447
##  [7,]  7 419
##  [8,]  8 390
##  [9,]  9 348
## [10,] 10 268
## [11,] 11 154
## [12,] 12  59
## [13,] 13   4
## [14,] 14   2
## [15,] 15   0</code></pre>

<div class="exercise">
<span id="exr:ovisDalliSupCurve" class="exercise"><strong>Exercise 3.5  </strong></span>Grafique la curva de supervivencia y mortalidad del ejercicio anterior.
</div>


<div class="exercise">
<span id="exr:ovisDalliRegCurve" class="exercise"><strong>Exercise 3.6  </strong></span>Estime una tasa de supervivencia común a todas las clases de edad de <em>Ovis dalli</em>, usando los datos del ejemplo <a href="demografia.html#exr:ovisDalli">3.4</a>. Use el método de análisis de curvas de captura por regresión.
</div>


</div>
</div>
<div id="matrices-de-transicion" class="section level2">
<h2><span class="header-section-number">3.4</span> Matrices de transición</h2>
<p>En la sección anterior, nos enfocamos en el cálculo de algunos parámetros de crecimiento poblacional utilizando tablas de vida. Las tablas de vida son útiles cuando tenemos clases de edad bien definidas, sin embargo, en algunos casos es más conveniente estructurar una población por <em>etapas</em>, y no por clases de edad. Para este caso, el uso de matrices es más apropiado.</p>
<p>Por ejemplo, algunos insectos pueden ser fácilmente descritos por etapas: huevo, larva, pupa y adulto. Igual que algunas plantas: semilla, plántula, flor, fruto. Incluso, los modelos matriciales son útiles en animales cuyas etapas de vida están mejor diferenciadas por el comportamiento, más que por la edad; es decir, la supervivencia en cada etapa está más relacionada con el comportamiento, que con la edad del individuo.</p>
<p>El paquete <strong>popbio</strong> de , contiene un conjunto de datos sobre la ballena asesina. En este conjunto de datos, la estructura de la población está mejor representada por sus etapas (Figura <a href="demografia.html#fig:plotWhale">3.5</a>). Entendemos del diagrama, que las flechas nacen de la etapa inicial y apuntan hacia la etapa a la cual se hará la transición. Vemos que en algunos casos, las flechas salen desde una etapa, y apuntan a sí mismas; en este caso, se habla de permanencia (<span class="math inline">\(P\)</span>). Si la etapa apunta a otra de mayor edad, se habla de crecimiento (<span class="math inline">\(G\)</span>). Finalmente, si la etapa apunta a una de menor edad se habla de fecundidad (<span class="math inline">\(F\)</span>).</p>
<div class="figure"><span id="fig:plotWhale"></span>
<img src="dinPob_files/figure-html/plotWhale-1.png" alt="Un diagrama que representa gráficamente una matriz de transición" width="672" />
<p class="caption">
Figure 3.5: Un diagrama que representa gráficamente una matriz de transición
</p>
</div>

<p>Las <strong>matrices de transición</strong> contienen la información sobre la probabilidad de pasar de un estado a otro (como en la figura <a href="demografia.html#fig:demoTMintro">3.1</a> también). Por ejemplo, para el diagrama de la ballena asesina, la matriz asociada es:</p>

<p></p>

<table>
<caption><span id="tab:whaleTM">Table 3.2: </span> Matriz de transición para la ballena asesina.</caption>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left"></td>
<td align="center"></td>
<td align="center">Desde etapa</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left"></td>
<td align="center">yearling</td>
<td align="center">juvenile</td>
<td align="center">mature</td>
<td align="center">postreprod</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">yearling</td>
<td align="center">0.0000</td>
<td align="center">0.0043</td>
<td align="center">0.1132</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="left">Hasta etapa</td>
<td align="left">juvenile</td>
<td align="center">0.9775</td>
<td align="center">0.9111</td>
<td align="center">0.0000</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">mature</td>
<td align="center">0.0000</td>
<td align="center">0.0736</td>
<td align="center">0.9534</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">postreprod</td>
<td align="center">0.0000</td>
<td align="center">0.0000</td>
<td align="center">0.0452</td>
<td align="center">0.9804</td>
</tr>
</tbody>
</table>

<p>Por convención, la matriz se lee desde las columnas hacia las filas. Es decir, si queremos encontrar la probabilidad de pasar de la etapa adulta, a la post-reproductiva, primero se ubica la columna de los adultos (<em>mature</em>), y luego se busca la fila de los post-reproductivos (<em>postrep</em>), y se lee la celda que interseca esa columna con esa fila. Para este caso es <span class="math inline">\(0.0452\)</span>.</p>
<div id="proyeccion-de-una-matriz-a-n_t1" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Proyección de una matriz a <span class="math inline">\(N_{t+1}\)</span></h3>
<p>Uno de los usos de las matrices de transición (también llamadas matrices poblacionales), es la proyección del tamaño de población en el tiempo. Esto es lo que el modelo de <em>Crecimiento Geométrico</em> hacía, pero con un tamaño de población global, sin estructura por etapas o edades.</p>
<p>Para proyectar una matriz, necesitamos entender la <strong>multiplicación matricial</strong>. Esta es una operación básica que se enseña en los cursos de álgebra lineal, y consiste en multiplicar los elementos de una matriz con los elementos de otra matriz o vector. Pero para ello, hay un orden específico.</p>
<p>Retomando la matriz de transición de la ballena asesina, pero sustituyendo los valores numéricos por símbolos, tenemos:</p>
<p></p>

<table>
<caption><span id="tab:whaleTMsym">Table 3.3: </span> Matriz de transición para la ballena asesina, expresada de manera simbólica.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">yearling</th>
<th align="center">juvenile</th>
<th align="center">mature</th>
<th align="center">postreprod</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">yearling</td>
<td align="center"></td>
<td align="center"><span class="math inline">\(F_{jy}\)</span></td>
<td align="center"><span class="math inline">\(F_{my}\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">juvenile</td>
<td align="center"><span class="math inline">\(G_{yj}\)</span></td>
<td align="center"><span class="math inline">\(P_{j}\)</span></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="left">mature</td>
<td align="center"></td>
<td align="center"><span class="math inline">\(G_{jm}\)</span></td>
<td align="center"><span class="math inline">\(P_m\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="left">postreprod</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(G_{mP}\)</span></td>
<td align="center"><span class="math inline">\(P_P\)</span></td>
</tr>
</tbody>
</table>

<p>Vamos a llamar a esta matriz <span class="math inline">\(\mathbf{A}\)</span>. Luego, para la proyección es necesario contar con un vector que contenga el número de individuos en el año (o unidad correspondiente) previo al que se desea proyectar. Es decir, si queremos proyectar a <span class="math inline">\(t+1\)</span>, debemos conocer el tamaño de población en el año <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[
\mathbf{n}_t = 
\begin{pmatrix}
n_y  \\ 
n_j   \\
n_m  \\
n_P
\end{pmatrix}
\]</span></p>
<p>Luego, representamos la operación como:</p>
<p><span class="math display">\[
\mathbf{n}_{t+1} = \mathbf{A}\mathbf{n}_t
\]</span></p>
<p>La expresión anterior es una forma corta de representar la multiplicación de matrices. Tanto los vectores como las matrices pueden ser representados en negrita; las matrices en mayúscula; los vectores en minúscula. Esta expresión simplifica la siguiente operación:</p>
<p><span class="math display">\[
\mathbf{n}_{t+1} = 
\begin{pmatrix}
      0   &amp; F_{jy}  &amp;  F_{my} &amp;  0      \\
 G_{yj} &amp;   P_{j}  &amp;  0        &amp;   0      \\
      0   &amp; G_{jm} &amp; P_m    &amp;   0      \\
      0   &amp;   0       &amp; G_{mP}&amp; P_P
 \end{pmatrix}
\times
\begin{pmatrix}
n_y  \\ 
n_j   \\
n_m  \\
n_P
 \end{pmatrix}
\]</span></p>
<p>El resultado de esta multiplicación es un arreglo con el número de filas iguales al primer multiplicando (la matriz), y el número de columnas iguales al segundo multiplicando (el vector). Por tanto, el resultado es un nuevo vector.</p>
<p>El <em>i</em>-ésimo elemento del vector <span class="math inline">\(\mathbf{n}_{t+1}\)</span>, se calcula como: <span class="math inline">\(\sum_{j=1}^k \mathbf{A}_{i,j}\cdot \mathbf{n}_j\)</span>. Todo el proceso se resume a continuación:</p>
<span class="math display" id="eq:TM">\[\begin{equation}
\mathbf{n}_{t+1} = 
\begin{pmatrix}
      0\cdot n_y   + F_{jy}\cdot n_j  +  F_{my}\cdot n_m +  0\cdot n_P      \\
       G_{yj}\cdot n_y +  P_{j}\cdot n_j  +  0\cdot n_m  +  0\cdot n_P      \\
      0\cdot n_y + G_{jm}\cdot n_j + P_m\cdot n_m   +   0\cdot n_P      \\
      0\cdot n_y  +   0\cdot n_j    + G_{mP}\cdot n_m + P_P\cdot n_P
 \end{pmatrix}
  \tag{3.1}
\end{equation}\]</span>

<div class="example">
<span id="exm:TMwhale" class="example"><strong>Example 3.2  </strong></span>Hacer una proyección a <span class="math inline">\(t+1\)</span> con la matriz de transición de la ballena asesina
</div>

<p>Vamos a asumir que se realizó un censo poblacional, y que los datos de abundancia se clasificaron según las etapas de la matriz de transición (Cuadro <a href="demografia.html#tab:whaleTM">3.2</a>). Los resultados del censo fueron:</p>
<p><span class="math display">\[
\mathbf{n}_t = 
\begin{pmatrix}
123  \\ 
87   \\
60  \\
64
\end{pmatrix}
\]</span></p>
<p>Si sustituimos los valores de la matriz de transición, y los datos del censo en la ecuación <a href="demografia.html#eq:TM">(3.1)</a>, tenemos:</p>
<p><span class="math display">\[
\mathbf{n}_{t+1} = 
\begin{pmatrix}
      0\cdot 123   + 0.0043  \cdot 87  +  0.1132\cdot 60 +  0\cdot 64      \\
       0.9775\cdot 123 +  0.9111\cdot 87+  0\cdot 60+  0\cdot 64      \\
      0\cdot 123 + 0.0736  \cdot 87 + 0.9534\cdot 60 +   0\cdot 64      \\
      0\cdot 123 +0\cdot 87    + 0.0452\cdot 60 + 0.9804\cdot 64
 \end{pmatrix}
\]</span></p>
<p>El resultado es:</p>
<p><span class="math display">\[
\mathbf{n}_{t+1} = 
\begin{pmatrix}
7.17  \\ 
199.5   \\
63.6  \\
65.5
\end{pmatrix}
\]</span></p>
<p>En :</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(popbio)
<span class="kw">data</span>(whale)

nt &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">123</span>, <span class="dv">87</span>, <span class="dv">60</span>, <span class="dv">64</span>)

ntp1 &lt;-<span class="st"> </span>whale<span class="op">%*%</span>nt <span class="co"># el &#39;%*%&#39;representa el operador para multiplicar</span>
                    <span class="co"># matrices en R</span>

ntp1</code></pre></div>
<pre><code>##              [,1]
## yearling     7.17
## juvenile   199.50
## mature      63.61
## postreprod  65.46</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#limpiar</span>
<span class="kw">detach</span>(<span class="st">&quot;package:popbio&quot;</span>, <span class="dt">unload =</span> <span class="ot">TRUE</span>)
<span class="kw">rm</span>(whale, ntp1, nt)</code></pre></div>
</div>
<div id="el-paquete-popbio" class="section level3">
<h3><span class="header-section-number">3.4.2</span> El paquete <strong>popbio</strong></h3>
<p>En la sección anterior se explicó cómo usar una matriz de transición para proyectar una población de <span class="math inline">\(t\)</span> a <span class="math inline">\(t+1\)</span>. Este proceso puede hacerse de manera iterativa a través de un ámbito de tiempo determinado. El resultado de esta operación es una Distribución Estable de Edad (<em>SAD</em> por sus siglas en inglés) <span class="citation">(Skalski, Ryding, and Millspaugh <a href="#ref-wildlifeDemography2005">2005</a>)</span>. Si la población mantiene una fecundidad específica por edad y tasas de supervivencia estables, ésta alcanzará una SAD que no depende de la población inicial. Esta condición es útil para calcular parámetros poblacionales la tasa de multiplicación <span class="math inline">\(\lambda\)</span>, la tasa reproductiva neta <span class="math inline">\(R_0\)</span>, el tiempo de generación <span class="math inline">\(T_c\)</span>, etc., aunque los detalles del cálculo quedan fuera del alcance del curso. En lugar de ello, se escoge una aproximación más práctica para calcular <span class="math inline">\(\lambda\)</span> usando el paquete <strong>popbio</strong> <span class="citation">(Stubben and Milligan <a href="#ref-Stubben2007">2007</a>)</span>. A continuación se presenta un resumen de las principales funciones del paquete <strong>popbio</strong>.</p>
<ul>
<li><p><code>pop.projection(TM,n0,t)</code>: Proyecta una población. <code>TM</code>: matriz de transición; <code>n0</code>: vector de tamaño de población inicial; <code>t</code>: cantidad de tiempo que se desea proyectar. Devuelve valores como <code>$lambda</code>: <span class="math inline">\(\lambda\)</span>, <code>$stable.stage</code>: la proporción estable de clases de edad, o etapas, en una población; <code>$stage.vectors</code>: la cantidad de individuos en cada clase de edad o etapa, desde el tiempo cero hasta el tiempo <code>t</code>; <code>$pop.sizes</code>: vector con el tamaño de la población total, desde el tiempo cero hasta el tiempo <code>t</code>; <code>$pop.changes</code>: el <span class="math inline">\(\lambda\)</span> desde el tiempo cero hasta el tiempo <code>t</code>.</p></li>
<li><p><code>stage.vector.plot(stage.vectors, col)</code>: grafica la matriz de transición con respecto al tiempo. <code>stage.vectors</code>: recibe la salida de la función <code>pop.projection</code>, específicamente el vector: <code>$stage.vectors</code>. El argumento <code>col</code> es una secuencia de enteros, con las columnas que se desean graficar.</p></li>
<li><p><code>fundamental.matrix(TM)</code>: Recibe una matriz de transición y devuelve una matriz fundamental, con los errores de estimación. La matriz fundamental tiene la misma estructura que una matriz de transición, pero sus elementos contienen el número de unidades de tiempo que pasa cada individuo en una <em>etapa</em> de crecimiento. Es apropiada para poblaciones con crecimiento estructurado por etapas.</p></li>
<li><p><code>net.reproductive.rate(TM)</code>: Devuelve el <span class="math inline">\(R_0\)</span> de una matriz de transición.</p></li>
<li><p><code>generation.time(TM)</code>: Devuelve el <span class="math inline">\(T_c\)</span> de una matriz de transición.</p></li>
<li><p><code>stoch.projection(matrices,n0,tmax,nreps,...)</code>: Genera una proyección estocástica de una población. <code>matrices</code>: Lista de matrices de transición (creadas a partir de la estimación de una matriz con valores de tendencia central y de dispersión. <code>n0</code>: vector con tamaño inicial de población; <code>tmax</code>: entero con el número de pasos de tiempo que quieren predecirse a futuro; <code>nreps</code>: número de pasos a iterar. Los detalles del método se encuentran en <span class="citation">Elderd, Shahani, and Doak (<a href="#ref-stochPVA">2003</a>)</span>.</p></li>
<li><p><code>stoch.growth.rate(matrices)</code>: Versión estocástica para calcular <em>el logaritmo</em> de la tasa de crecimiento.</p></li>
<li><p><code>stoch.quasi.ext(matrices, n0, Nx, tmax, maxruns, nreps)</code>. Hace una proyección de la probabilidad de extinción de una población. Cuyos argumentos son:</p>
<ul>
<li><p><code>matrices</code>: Una lista con dos o más matrices de transición</p></li>
<li><p><code>n0</code>: Vector con tamaño de población inicial.</p></li>
<li><p><code>Nx</code>: Umbral de quasi-extinción.</p></li>
<li><p><code>tmax</code>: número de pasos a proyectar en el futuro.</p></li>
<li><p><code>maxruns</code>: Número de veces que se simula la distribución acumulativa sobre la probabilidad de extinción.</p></li>
<li><p><code>nreps</code>: Número de iteraciones.</p></li>
</ul></li>
</ul>
<div id="estimacion-de-parametros-basicos-con" class="section level4">
<h4><span class="header-section-number">3.4.2.1</span> Estimación de parámetros básicos con</h4>
<p>Para simplificar las cosas, las funciones del paquete <strong>popbio</strong> se han reunido en dos <em>clases de referencia</em>. Las clases de referencia son objetos en  que contienen los datos y los métodos para analizarlos en un solo objeto. Las funciones para crear estas clases de referencia se encuentran en el archivo <code>Source.R</code> dentro del repositorio de este material.</p>
<p>La clase <code>transMat</code> toma como argumentos a: <code>matriz</code>: una matriz de transición; <code>n0</code>: un vector con el tamaño de población inicial; <code>t</code>: el número de pasos de tiempo a proyectar la población. Por ejemplo, para calcular los parámetros de crecimiento de la ballena asesina, asumiendo una población inicial de <span class="math inline">\(n_0 = \left\{100,80,40,20\right\}\)</span> utilizamos el siguiente comando:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(popbio)
<span class="kw">data</span>(whale)

whaleTM &lt;-<span class="st"> </span>transMat<span class="op">$</span><span class="kw">new</span>(<span class="dt">matriz=</span>whale,<span class="dt">n0 =</span> <span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">80</span>,<span class="dv">60</span>,<span class="dv">40</span>),<span class="dt">t =</span> <span class="dv">15</span>)</code></pre></div>
<p>Al crear este objeto, se ha utilizado un <em>constructor</em> con el nombre de la clase <code>transMat</code> seguido de la instrucción <code>$new(...)</code>, que indica a  que se quiere crear una nueva instancia de esta clase. Seguidamente le pasamos los datos a los argumentos <code>matriz=whale,n0 = c(100,80,60,40),t = 15</code>. Y guardamos todo en un nuevo objeto llamado <code>whaleTM</code>. Este objeto contiene los datos, pero también las funciones para calcular los parámetros poblacionales</p>
<p>Para graficar los resultados de la proyección utilizamos el comando <code>whaleTM$plotTM()</code> (Figura <a href="demografia.html#fig:whaleplotTM">3.6</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:whaleplotTM"></span>
<img src="dinPob_files/figure-html/whaleplotTM-1.png" alt="Resultados de la proyección de la matriz de transición" width="816" />
<p class="caption">
Figure 3.6: Resultados de la proyección de la matriz de transición
</p>
</div>
<p>Para graficar los resultados la proporción de la población en cada etapa existe el comando <code>whaleTM$plotStage()</code> (Figura <a href="demografia.html#fig:whaleplotStage">3.7</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:whaleplotStage"></span>
<img src="dinPob_files/figure-html/whaleplotStage-1.png" alt="Proporción de la población en cada etapa de edad" width="816" />
<p class="caption">
Figure 3.7: Proporción de la población en cada etapa de edad
</p>
</div>
<p>Las demás funciones para calcular parámetros poblacionales se presentan abajo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># La tasa de multiplicación</span>
whaleTM<span class="op">$</span><span class="kw">darLambda</span>()</code></pre></div>
<pre><code>## [1] 1.03</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#La tasa de crecimiento neto</span>
whaleTM<span class="op">$</span><span class="kw">darR0</span>()</code></pre></div>
<pre><code>## [1] 2.01</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#El tiempo de generación</span>
whaleTM<span class="op">$</span><span class="kw">darTc</span>()</code></pre></div>
<pre><code>## [1] 27.9</code></pre>
</div>
</div>
<div id="viabilidad-de-poblaciones" class="section level3">
<h3><span class="header-section-number">3.4.3</span> Viabilidad de poblaciones</h3>
<p>Los gestores de vida silvestre utilizan las proyecciones de población para evaluar escenarios de manejo. Por ejemplo, ¿cuál es la probabilidad de extinción de una población en diez años, si se extraen 10 toneladas anuales de juveniles? Para responder este tipo de preguntas existen una serie de métodos de <em>Análisis de Viabilidad de Poblaciones</em> (<em>PVA</em>, por sus siglas en inglés). Veremos a en los siguientes párrafos un PVA basado en proyecciones de población, que son determinadas de matrices de transición con estocasticidad.</p>
<p>La estocasticidad es la variación causada por factores aleatorios. En el caso de las matrices de transición, existen diversos factores aportan incertidumbre a la estimación de la cantidad de individuos supervivientes en cada clase. Esto quiere decir, que la supervivencia en cada celda de la matriz no es un valor fijo, sino, una variable aleatoria que tiene una distribución de probabilidad asociada.</p>
<p>Por ejemplo, suponga que en un muestreo se tiene que la etapa <span class="math inline">\(S_1\)</span> de una población se contaron un total de mil individuos, de los cuales cien pasan a la siguiente generación, seiscientos permanecen en dicha clase, y trescientos mueren. Entonces, las probabilidades de supervivencia son variables aleatorias asociadas a una distribución de probabilidad Beta, y se puede representar como:</p>
<p><span class="math display">\[
\begin{split}
S_{1,1} &amp;\sim \text{Beta}(600,400)\\
S_{1,2} &amp;\sim \text{Beta}(100,900)\\
\end{split}
\]</span></p>
<p>Este planteamiento permite obtener una infinidad de muestras de <span class="math inline">\(S_{1,1}\)</span> o <span class="math inline">\(S_{1,2}\)</span>. Y asumiendo que el resto de etapas de la población hayan sido determinadas de la misma forma, entonces podemos obtener una infinidad de matrices de transición del conjunto de distribuciones de probabilidad. Cuando sea posible obtener muestras de la matriz de transición para una población, el paquete <strong>popbio</strong> ofrece métodos para estimar parámetros de población de manera estocástica.</p>
<p>Una vez cargado el paquete, la información sobre estas funciones se puede acceder usando: <code>?stoch.projection</code>, para realizar una proyección poblacional estocástica y obtener una aproximación de una distribución de probabilidad alrededor del tamaño poblacional; <code>?stoch.quasi.ext</code>, para analizar la probabilidad de extinción de una población a cierto número de años (o pasos de tiempo), bajo cierto umbral de individuos. Es decir, el investigador objetivamente indica un tamaño poblacional del cual se asume que la población no puede recuperarse, y el algoritmo calcula la probabilidad de que el tamaño de población se encuentre bajo este umbral.</p>
<p>El archivo <code>Source.R</code> provee una clase de referencia para los métodos estocásticos del paquete <strong>popbio</strong>. Esta clase lleva el nombre de <code>transStochMat</code>. Los argumentos para crear dicha clase son:</p>
<ul>
<li><p><code>matriz</code>: una <em>lista</em> de matrices de transición. Se pueden generar a partir de las distribuciones de probabilidad asociadas a la estimación de los elementos de una matriz de transición.</p></li>
<li><p><code>n0</code>: El vector con el tamaño de población inicial.</p></li>
<li><p><code>t</code>: El valor máximo de los pasos de tiempo hacia los cuales se desea proyectar la población.</p></li>
<li><p><code>umbral</code>: El número mínimo de individuos bajo el cual la población se considera cuasi-extinta.</p></li>
<li><p><code>incluirEtapa</code>: Un vector de elementos binarios (unos y ceros), que indica cuales etapas o clases de edad deben incluirse en el análisis (unos), y cuales deben excluirse (ceros).</p></li>
</ul>
<p>Para demostrar el uso de la clase de referencia, se utilizan los datos del paquete <strong>popbio</strong>. El conjunto de datos se llama <em>hudsonia</em> y ya provee una lista de matrices de transición.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># hudsonia es una lista de matrices de transición</span>
<span class="kw">data</span>(<span class="st">&quot;hudsonia&quot;</span>)
n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4264</span>, <span class="dv">3</span>, <span class="dv">30</span>, <span class="dv">16</span>, <span class="dv">25</span>, <span class="dv">5</span>)
<span class="kw">names</span>(n) &lt;-
<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;seed&quot;</span>, <span class="st">&quot;seedlings&quot;</span>, <span class="st">&quot;tiny&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;medium&quot;</span>, <span class="st">&quot;large&quot;</span>)


hudsoniaStoch &lt;-<span class="st"> </span>transStochMat<span class="op">$</span><span class="kw">new</span>(
  <span class="dt">matriz =</span> hudsonia,
  <span class="dt">n0 =</span> n,
  <span class="dt">t =</span> <span class="dv">50</span>,
  <span class="dt">umbral =</span> <span class="dv">10</span>,<span class="co"># Número de plantas con potencial reproductivo.</span>
  <span class="dt">incluirEtapa =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>)
)</code></pre></div>
<p>Una vez creado el objeto. Existen varias funciones asociadas para observar los resultados. Por ejemplo, para observar la distribución de probabilidad alrededor de la población (solo etapas seleccionadas en <code>incluirEtapa</code>) se utiliza el comando <code>hudsoniaStoch$plotN()</code> (Figura <a href="demografia.html#fig:hudsoniaplotN">3.8</a>). La línea gris representa el tamaño de población inicial y la roja, el tamaño de población de cuasi-extinción.</p>
<div class="figure" style="text-align: center"><span id="fig:hudsoniaplotN"></span>
<img src="dinPob_files/figure-html/hudsoniaplotN-1.png" alt="Población total de \textit{hudsonia} a 50 años" width="528" />
<p class="caption">
Figure 3.8: Población total de  a 50 años
</p>
</div>
<p>Para observar la probabilidad de cuasi-extinción de la población (solo etapas seleccionadas en <code>incluirEtapa</code>), se digita <code>hudsoniaStoch$plotExtProb()</code> (Figura <a href="demografia.html#fig:hudsoniaplotExtProb">3.9</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:hudsoniaplotExtProb"></span>
<img src="dinPob_files/figure-html/hudsoniaplotExtProb-1.png" alt="Probabilidad de extinción de \textit{hudsonia} a 50 años. Umbral de quasi-extición 10 individuos sobre tierra." width="528" />
<p class="caption">
Figure 3.9: Probabilidad de extinción de  a 50 años. Umbral de quasi-extición 10 individuos sobre tierra.
</p>
</div>
<p>El parámetro de crecimiento con su incertidumbre asociada se obtiene así:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># GR estocástico</span>
hudsoniaStoch<span class="op">$</span><span class="kw">darGR</span>()</code></pre></div>
<pre><code>## [1] Calculating stochastic growth at time 1
## [1] Calculating stochastic growth at time 10000
## [1] Calculating stochastic growth at time 20000
## [1] Calculating stochastic growth at time 30000
## [1] Calculating stochastic growth at time 40000
## [1] Calculating stochastic growth at time 50000</code></pre>
<pre><code>## $approx
## [1] 0.964
## 
## $sim
## [1] 0.964
## 
## $simCI
## [1] 0.964 0.965</code></pre>
<p>Por último, la probabilidad de que la población se encuentre por debajo del umbral establecido, al finaliza el número de pasos de tiempo es:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">hudsoniaStoch<span class="op">$</span><span class="kw">extProb</span>()</code></pre></div>
<pre><code>## [1] 0.465</code></pre>
</div>
</div>
<div id="otras-fuentes-bibliograficas-1" class="section level2">
<h2><span class="header-section-number">3.5</span> Otras fuentes bibliográficas</h2>
<p>En <span class="citation">Neal (<a href="#ref-NealPopBio">2004</a>)</span> se da una introducción gentil a la demografía, pero los métodos de análisis son limitados a unos pocos; básicamente, se limitan a enseñar las técnicas necesarias para comprender los fundamentos detrás de cada análisis. Por otro lado, <span class="citation">Skalski, Ryding, and Millspaugh (<a href="#ref-wildlifeDemography2005">2005</a>)</span> describe detalladamente las variantes de cada técnica, con un enfoque práctico; además, presenta discusiones sobre la utilidad de cada método de análisis y sus supuestos. Como nota precautoria, en <span class="citation">Skalski, Ryding, and Millspaugh (<a href="#ref-wildlifeDemography2005">2005</a>)</span>, las convenciones sobre los nombres de las columnas de las tablas de vida difieren a las expuestas en este material.</p>
<p>Una pequeña reseña histórica, acompañada de una introducción gentil a los modelos de matrices se da en <span class="citation">Neal (<a href="#ref-NealPopBio">2004</a>)</span>. Mientras que los detalles matemáticos de los cálculos relacionados con los modelos de matrices se da en <span class="citation">Skalski, Ryding, and Millspaugh (<a href="#ref-wildlifeDemography2005">2005</a>)</span>. También se recomienda el uso de libros de Álgebra Lineal como referencia, al estudiar modelos matriciales.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-NealPopBio">
<p>Neal, Dick. 2004. <em>Introduction to population biology</em>. Cambridge, UK: Cambridge.</p>
</div>
<div id="ref-wildlifeDemography2005">
<p>Skalski, John R, Kristin E Ryding, and Joshua Millspaugh. 2005. <em>Wildlife demography: analysis of sex, age, and count data</em>. Elsevier. doi:<a href="https://doi.org/10.1007/s13398-014-0173-7.2">10.1007/s13398-014-0173-7.2</a>.</p>
</div>
<div id="ref-Stubben2007">
<p>Stubben, Chris, and Brook Milligan. 2007. “Estimating and analyzing demographic models.” <em>Journal of Statistical Software</em> 22 (11): 1–23. doi:<a href="https://doi.org/10.18637/jss.v022.i11">10.18637/jss.v022.i11</a>.</p>
</div>
<div id="ref-stochPVA">
<p>Elderd, B D, P Shahani, and D F Doak. 2003. “7 The Problems and Potential of Count-Based.” In <em>Population Viability in Plants</em>, edited by C.A. Brigham and M.W. Schwartz. Vol. 165. Berlin Heidelberg: Springer-Verlag. <a href="https://www.lsu.edu/faculty/elderd/ewExternalFiles/ElderdShahaniDoak.pdf" class="uri">https://www.lsu.edu/faculty/elderd/ewExternalFiles/ElderdShahaniDoak.pdf</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="modelos-de-crecimiento.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="soluciones-a-los-ejercicios.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["dinPob.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
