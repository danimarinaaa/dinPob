<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Ecología de poblaciones silvestres</title>
  <meta name="description" content="Este es el manual del curso ‘Ecología de Poblaciones Silvestres’, de las Escuela de Ciencias Biológicas de la Universidad Nacional">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="Ecología de poblaciones silvestres" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Este es el manual del curso ‘Ecología de Poblaciones Silvestres’, de las Escuela de Ciencias Biológicas de la Universidad Nacional" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Ecología de poblaciones silvestres" />
  
  <meta name="twitter:description" content="Este es el manual del curso ‘Ecología de Poblaciones Silvestres’, de las Escuela de Ciencias Biológicas de la Universidad Nacional" />
  

<meta name="author" content="David Martínez Cascante">


<meta name="date" content="2018-02-14">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="soluciones-a-los-ejercicios.html">
<link rel="next" href="tutorial-de-r-con-rstudio.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a></li>
<li class="chapter" data-level="2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html"><i class="fa fa-check"></i><b>2</b> Modelos de crecimiento</a><ul>
<li class="chapter" data-level="2.1" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-denso-independiente"><i class="fa fa-check"></i><b>2.1</b> Crecimiento denso-independiente</a><ul>
<li class="chapter" data-level="2.1.1" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-geometrico"><i class="fa fa-check"></i><b>2.1.1</b> Crecimiento geométrico</a></li>
<li class="chapter" data-level="2.1.2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-exponencial"><i class="fa fa-check"></i><b>2.1.2</b> Crecimiento exponencial</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#crecimiento-denso-dependiente"><i class="fa fa-check"></i><b>2.2</b> Crecimiento denso-dependiente</a><ul>
<li class="chapter" data-level="2.2.1" data-path="modelos-de-crecimiento.html"><a href="modelos-de-crecimiento.html#matrices"><i class="fa fa-check"></i><b>2.2.1</b> Matrices</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="soluciones-a-los-ejercicios.html"><a href="soluciones-a-los-ejercicios.html"><i class="fa fa-check"></i><b>3</b> Soluciones a los ejercicios</a></li>
<li class="appendix"><span><b>Apéndices</b></span></li>
<li class="chapter" data-level="A" data-path="metodos-numericos-para-ecologia-de-poblaciones.html"><a href="metodos-numericos-para-ecologia-de-poblaciones.html"><i class="fa fa-check"></i><b>A</b> Métodos numéricos para ecología de poblaciones</a><ul>
<li class="chapter" data-level="A.1" data-path="metodos-numericos-para-ecologia-de-poblaciones.html"><a href="metodos-numericos-para-ecologia-de-poblaciones.html#simulacion-de-ecuaciones-diferenciales"><i class="fa fa-check"></i><b>A.1</b> Simulación de ecuaciones diferenciales</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html"><i class="fa fa-check"></i><b>B</b> Tutorial de R con RStudio</a><ul>
<li class="chapter" data-level="B.1" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#crear-un-proyecto-en-rstudio"><i class="fa fa-check"></i><b>B.1</b> Crear un proyecto en <em>RStudio</em></a></li>
<li class="chapter" data-level="B.2" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#funciones-basicas-en-r"><i class="fa fa-check"></i><b>B.2</b> Funciones básicas en R</a></li>
<li class="chapter" data-level="B.3" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#estructuras-de-datos"><i class="fa fa-check"></i><b>B.3</b> Estructuras de datos</a></li>
<li class="chapter" data-level="B.4" data-path="tutorial-de-r-con-rstudio.html"><a href="tutorial-de-r-con-rstudio.html#funciones"><i class="fa fa-check"></i><b>B.4</b> Funciones</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Ecología de poblaciones silvestres</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="metodos-numericos-para-ecologia-de-poblaciones" class="section level1">
<h1><span class="header-section-number">A</span> Métodos numéricos para ecología de poblaciones</h1>
<div id="simulacion-de-ecuaciones-diferenciales" class="section level2">
<h2><span class="header-section-number">A.1</span> Simulación de ecuaciones diferenciales</h2>
<p>Tomaremos el ejemplo de la ecuación <a href="modelos-de-crecimiento.html#eq:diffG">(2.3)</a>, para mostrar un método para encontrar el tamaño de población, sin tener que utilizar cálculo. Este es el <em>método de Euler</em>, que se explicará mediante un ejemplo.</p>
<p>Una derivada implica un cambio infinitesimal de una variable en relación a otra. Por ejemplo, el cambio en el número de individuos de una población en un momento pequeñísimo de tiempo, puede representarse como la diferencia de la población, entre la duración de ese pequeño intervalo de tiempo:</p>
<p><span class="math display">\[
\frac{dN}{dt} \approx \frac{\Delta N}{\Delta t} = \frac{N_t - N_{t-\Delta t}}{\Delta t}
\]</span></p>
<p>Si sustituimos en la ecuación <a href="modelos-de-crecimiento.html#eq:expG">(2.4)</a>, tenemos:</p>
<p><span class="math display">\[
\frac{N_t - N_{t-\Delta t}}{\Delta t} = r_m N
\]</span></p>
<p>Arreglando la expresión anterior, podemos despejar en terminos de <span class="math inline">\(N_t\)</span>:</p>
<p><span class="math display">\[
N_t= N_{t-\Delta t} + r_m N_{t-\Delta t} \Delta t
\]</span></p>
<p>Hay que resaltar que esta <strong>no</strong> es una solución exacta; sino, una aproximación. Entre más pequeño se haga <span class="math inline">\(\Delta t\)</span>, más se aproximará el resultado, al valor exacto dado por <a href="modelos-de-crecimiento.html#eq:expG">(2.4)</a>. En casos donde no existe una solución analítica, o simplemente, no es sencillo resolver la ecuación, siempre se puede recurrir a los métodos numéricos, para tener una idea de la solución real.</p>
<p>Para programar este sencillo ejemplo, necesitamos varios pasos:</p>
<ul>
<li><p>Definir un valor inicial de la población, y el valor de <span class="math inline">\(t\)</span> en el cuál queremos conocer el tamaño de población.</p></li>
<li><p>Definir el Valor de <span class="math inline">\(r_m\)</span>.</p></li>
<li><p>Establecer un criterio para guardar el valor de <span class="math inline">\(N_t\)</span>, cada cierto lapso de tiempo. (Para no crear un objeto virtual innecesariamente grande)</p></li>
<li><p>Crear un objeto para guardar el tamaño de la población, y los puntos de tiempo a los que está asociada.</p></li>
<li><p>Definir el tamaño de <span class="math inline">\(\Delta t\)</span>, y calcular el número de iteraciones necesarias hasta llegar al final del periodo de tiempo de interés.</p></li>
<li><p>Crear un bucle, y ejecutar iteractivamente la integración de Euler.</p></li>
<li><p>Definir un criterio para detener el algoritmo.</p></li>
</ul>
<p>El siguiente algoritmo generaliza todas las funciones dependientes de <span class="math inline">\(N_{t-\Delta t}\)</span>.</p>
<p><span class="math display">\[
N_t= N_{t-\Delta t} + f \left( N_{t-\Delta t},\mathbf{c} \right) \Delta t
\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{c}\)</span> son constantes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">euler &lt;-<span class="st"> </span><span class="cf">function</span>(fooName, valInic, tiempoParar, deltaT,guardarCada,...){
  arg &lt;-<span class="st"> </span><span class="kw">list</span>(...)
  fn &lt;-<span class="st"> </span><span class="kw">get</span>(fooName)
  
  <span class="co">#Encuentra los argumentos provistos</span>
  argName &lt;-<span class="st"> </span><span class="kw">match.arg</span>(<span class="kw">names</span>(arg),<span class="co">#arg provistos</span>
                       <span class="kw">formalArgs</span>(fn),<span class="co">#arg existentes</span>
                       <span class="dt">several.ok =</span> <span class="ot">TRUE</span>)
  <span class="co">#Nombra la lista con los nombres de los argumentos provistos</span>
  <span class="kw">names</span>(arg) &lt;-<span class="st"> </span>argName
  
  val &lt;-<span class="st"> </span><span class="kw">numeric</span>()
  val[<span class="dv">1</span>] &lt;-<span class="st"> </span>valInic
  
  valTmp &lt;-<span class="st"> </span><span class="kw">numeric</span>()
  valTmp &lt;-<span class="st"> </span>val[<span class="dv">1</span>]
  
  <span class="co">#Completa la lista de argumentos con N[t-1]</span>
  arg[[ (<span class="kw">length</span>(arg)<span class="op">+</span><span class="dv">1</span>) ]] &lt;-<span class="st"> </span>valInic
  totalArg &lt;-<span class="st"> </span><span class="kw">length</span>(arg)
  <span class="co">#Escribe todos los nomres de los argumentos, para do.call</span>
  <span class="kw">names</span>(arg) &lt;-<span class="st"> </span><span class="kw">formalArgs</span>(fn)<span class="co">#Encuetra los nombres de los argumentos</span>
  
  tiempo &lt;-<span class="st"> </span><span class="kw">numeric</span>()
  
  tNow &lt;-<span class="st"> </span><span class="dv">0</span>
  tiempo[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
  
  <span class="cf">while</span>( tNow <span class="op">&lt;</span><span class="st"> </span>tiempoParar ){
    valTmp &lt;-<span class="st"> </span>valTmp <span class="op">+</span><span class="st"> </span><span class="kw">do.call</span>(fn,<span class="dt">args =</span> arg)<span class="op">*</span>deltaT
    tNow &lt;-<span class="st"> </span>tNow <span class="op">+</span><span class="st"> </span>deltaT 
      
    <span class="cf">if</span>( tNow<span class="op">%%</span>guardarCada <span class="op">&lt;=</span>deltaT ){
      val &lt;-<span class="st"> </span><span class="kw">append</span>(<span class="dt">x =</span> val,<span class="dt">values =</span> valTmp)
      tiempo &lt;-<span class="st"> </span><span class="kw">append</span>(<span class="dt">x =</span> tiempo, <span class="dt">values =</span> tNow)
      arg[[totalArg]] &lt;-<span class="st"> </span>valTmp
    }
  }
  
  <span class="kw">return</span>( <span class="kw">list</span>(
    <span class="dt">poblacion =</span> val,
    <span class="dt">tiempo =</span> tiempo,
    <span class="dt">tNow =</span> tNow,
    <span class="dt">arg =</span> arg
  ) )
  
}</code></pre></div>
<p>Por ejemplo</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">diffG1 &lt;-<span class="st"> </span><span class="cf">function</span>(rm, N) N <span class="op">*</span><span class="st"> </span>rm
N0 &lt;-<span class="st"> </span><span class="dv">10</span>

Resultados1 &lt;-<span class="st"> </span><span class="kw">euler</span>(<span class="dt">fooName =</span> <span class="st">&quot;diffG1&quot;</span>, <span class="dt">valInic =</span> N0, <span class="dt">tiempoParar =</span> <span class="dv">10</span>, <span class="dt">deltaT =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">100</span>, 
    <span class="dt">guardarCada =</span> <span class="dv">1</span>, <span class="dt">rm =</span> <span class="fl">0.22</span>)

diffG2 &lt;-<span class="st"> </span><span class="cf">function</span>(rm, Kmax, N) rm <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>N<span class="op">/</span>Kmax)

N0 &lt;-<span class="st"> </span><span class="dv">10</span>

Resultados2 &lt;-<span class="st"> </span><span class="kw">euler</span>(<span class="dt">fooName =</span> <span class="st">&quot;diffG2&quot;</span>, <span class="dt">valInic =</span> N0, <span class="dt">tiempoParar =</span> <span class="dv">50</span>, <span class="dt">deltaT =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">100</span>, 
    <span class="dt">guardarCada =</span> <span class="dv">1</span>, <span class="dt">rm =</span> <span class="fl">1.92</span>, <span class="dt">Kmax =</span> <span class="dv">60</span>)

<span class="kw">plot</span>(Resultados1<span class="op">$</span>tiempo, Resultados1<span class="op">$</span>poblacion, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, 
    <span class="dt">ylab =</span> <span class="st">&quot;Tamaño de población&quot;, las = 1, pch = 21, bg = 1)</span>
<span class="st">lines(Resultados1$tiempo, Resultados1$poblacion)</span></code></pre></div>
<p><img src="dinPob_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(Resultados2<span class="op">$</span>tiempo, Resultados2<span class="op">$</span>poblacion, <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, 
    <span class="dt">ylab =</span> <span class="st">&quot;Tamaño de población&quot;, las = 1, pch = 21, bg = 1)</span>
<span class="st">lines(Resultados2$tiempo, Resultados2$poblacion)</span></code></pre></div>
<p><img src="dinPob_files/figure-html/unnamed-chunk-4-2.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="soluciones-a-los-ejercicios.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tutorial-de-r-con-rstudio.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["dinPob.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
